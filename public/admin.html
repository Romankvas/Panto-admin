<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>–ê–¥–º—ñ–Ω–∫–∞</title>
<style>
body { font-family: Arial; padding: 20px; }
table { border-collapse: collapse; width: 100%; margin-top: 20px; }
td, th { border: 1px solid #ccc; padding: 8px; }
img { width: 50px; }
button { cursor: pointer; }
</style>
</head>
<body>

<h1>üõçÔ∏è –ê–¥–º—ñ–Ω–∫–∞</h1>

<form id="form">
    <input name="name" placeholder="–ù–∞–∑–≤–∞" required><br>
    <input name="price" type="number" placeholder="–¶—ñ–Ω–∞" required><br>
    <input name="category" placeholder="–ö–∞—Ç–µ–≥–æ—Ä—ñ—è"><br>
    <input type="file" name="image" required><br><br>
    <button>–î–æ–¥–∞—Ç–∏</button>
</form>

<table>
<thead>
<tr>
<th>–§–æ—Ç–æ</th>
<th>–ù–∞–∑–≤–∞</th>
<th>–¶—ñ–Ω–∞</th>
<th>–î—ñ—è</th>
</tr>
</thead>
<tbody id="list"></tbody>
</table>

<script>
async function load() {
    const res = await fetch('/products');
    const data = await res.json();
    const list = document.getElementById('list');
    list.innerHTML = '';

    data.forEach(p => {
        list.innerHTML += `
        <tr>
            <td><img src="/${p.imageUrl}"></td>
            <td>${p.name}</td>
            <td>${p.price}</td>
            <td><button onclick="del('${p._id}')">‚ùå</button></td>
        </tr>`;
    });
}

async function del(id) {
    await fetch('/admin/products/' + id, { method: 'DELETE' });
    load();
}

document.getElementById('form').onsubmit = async e => {
    e.preventDefault();
    const fd = new FormData(e.target);
    await fetch('/admin/products', {
        method: 'POST',
        body: fd
    });
    e.target.reset();
    load();
};

load();
</script>

</body>
</html>
